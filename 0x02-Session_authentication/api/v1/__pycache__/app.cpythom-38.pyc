U 
&#x0;&#x0;&#x0;&#x0;m`fK&#x0;&#x0;�&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;@&#x0;&#x0;&#x0;s�&#x0;&#x0;d&#x0;Z&#x0;ddlmZ&#x0;ddlmZ&#x0;ddlmZmZmZm        Z        &#x0;ddl
mZmZ&#x0;ddlZddlmZ&#x0;ddl mZ&#x0;ddlmZ&#x0;dd        lmZ&#x0;dd
lmZ&#x0;ee�Ze�e�&#x0;eeddd iid�&#x0;dZedd�Zedkr�e�&#x0;Zedkr�e�&#x0;Zedkr�e�&#x0;Zedkr�e�&#x0;Zedk�re�&#x0;Ze�d�ed�dd��Ze�d�ed�dd��Ze�d�ed�dd��Zej dd �&#x0;�Z!ed!k�r�ed"d#�Z"ed$d%�Z#ej$e"e#d&�&#x0;dS&#x0;)'z
Route module for the API
�&#x0;&#x0;&#x0;&#x0;)�getenv)�        app_views)�Flask�jsonify�abort�request)�CORS�cross_originN)�Auth)�        BasicAuth)�SessionAuth)�SessionExpAuthz        /api/v1/*Zorigins�*)Z        resourcesZ        AUTH_TYPE�authZ
basic_authZsession_authZsession_exp_authZsession_db_auth�&#x0;&#x0;)�returnc&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;C&#x0;&#x0;&#x0;s&#x0;&#x0;&#x0;t&#x0;ddi�dfS&#x0;)z Not found handler
    �errorz        Not foundr&#x0;&#x0;&#x0;�r&#x0;&#x0;&#x0;�r&#x0;&#x0;&#x0;�&#x0;r&#x0;&#x0;&#x0;�@/alx-backend-user-data/0x02-Session_authentication/api/v1/app.py�        not_found#&#x0;&#x0;&#x0;s&#x0;&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;�&#x0;&#x0;c&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;C&#x0;&#x0;&#x0;s&#x0;&#x0;&#x0;t&#x0;ddi�dfS&#x0;)z"Task 1: Unauthorized handler.
    r&#x0;&#x0;&#x0;ZUnauthorizedr&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;�unauthorized*&#x0;&#x0;&#x0;s&#x0;&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;�&#x0;&#x0;c&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;C&#x0;&#x0;&#x0;s&#x0;&#x0;&#x0;t&#x0;ddi�dfS&#x0;)zTask 2: Forbidden handler.
    r&#x0;&#x0;&#x0;Z        Forbiddenr&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;�        forbidden1&#x0;&#x0;&#x0;s&#x0;&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;c&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;&#x0;C&#x0;&#x0;&#x0;sf&#x0;&#x0;&#x0;t&#x0;rbddddg}&#x0;t&#x0;�tj|&#x0;�rbt&#x0;�t�}t&#x0;�t�dkrLt&#x0;�t�dkrLtd�&#x0;|dkr\td�&#x0;|t_dS&#x0;)zBTask 5: Authenticates a user before
    processing a request.
    z/api/v1/status/z/api/v1/unauthorized/z/api/v1/forbidden/z/api/v1/auth_session/login/Nr&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;)r&#x0;&#x0;&#x0;Zrequire_authr&#x0;&#x0;&#x0;�pathZcurrent_userZauthorization_headerZsession_cookier&#x0;&#x0;&#x0;)Zexcluded_paths�userr&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;�authenticate_user8&#x0;&#x0;&#x0;s&#x0;&#x0;&#x0;&#x0;�
�r&#x0;&#x0;&#x0;�__main__ZAPI_HOSTz0.0.0.0ZAPI_PORTZ5000)�host�port)%�__doc__�osr&#x0;&#x0;&#x0;Zapi.v1.viewsr&#x0;&#x0;&#x0;Zflaskr&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;Z
flask_corsr&#x0;&#x0;&#x0;r        &#x0;&#x0;&#x0;Zapi.v1.auth.authr
&#x0;&#x0;&#x0;Zapi.v1.auth.basic_authr&#x0;&#x0;&#x0;Zapi.v1.auth.session_authr&#x0;&#x0;&#x0;Zapi.v1.auth.session_exp_authr &#x0;&#x0;&#x0;�__name__ZappZregister_blueprintr&#x0;&#x0;&#x0;Z        auth_typeZ SessionDBAuthZerrorhandler�strr&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;Zbefore_requestr&#x0;&#x0;&#x0;r &#x0;&#x0;&#x0;r!&#x0;&#x0;&#x0;�runr&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;r&#x0;&#x0;&#x0;�<module>&#x0;&#x0;&#x0;sJ&#x0;&#x0;&#x0;
